{"ast":null,"code":"import _asyncToGenerator from \"D:/\\u524D\\u7AEF\\u653B\\u514B/\\u5C1A\\u7845\\u8C37Vue/\\u9879\\u76EE/app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport _objectSpread from \"D:/\\u524D\\u7AEF\\u653B\\u514B/\\u5C1A\\u7845\\u8C37Vue/\\u9879\\u76EE/app/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";\nimport \"regenerator-runtime/runtime.js\";\nimport \"core-js/modules/es.array.find.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { mapState } from 'vuex';\nexport default {\n  name: 'Trade',\n  data: function data() {\n    return {\n      msg: '',\n      orderId: ''\n    };\n  },\n  mounted: function mounted() {\n    this.$store.dispatch('getUserAddress');\n    this.$store.dispatch('getOrderInfo');\n  },\n  computed: _objectSpread(_objectSpread({}, mapState({\n    addressInfo: function addressInfo(state) {\n      return state.trade.address;\n    },\n    orderInfo: function orderInfo(state) {\n      return state.trade.orderInfo;\n    }\n  })), {}, {\n    userDefaultAddress: function userDefaultAddress() {\n      // find查找数组中符合条件的元素\n      var userDefaultAddress = this.addressInfo.find(function (item) {\n        return item.isDefault == 1;\n      });\n      return userDefaultAddress || {};\n    }\n  }),\n  methods: {\n    // 修改默认地址\n    changeDefault: function changeDefault(address, addressInfo) {\n      addressInfo.forEach(function (item) {\n        return item.isDefault = 0;\n      });\n      address.isDefault = 1;\n    },\n    submitOrder: function submitOrder() {\n      var _this = this;\n\n      return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        var tradeNo, data, result;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                tradeNo = _this.orderInfo.tradeNo;\n                data = {\n                  // 最终收件人的名字\n                  consignee: _this.userDefaultAddress.consignee,\n                  // 最终收件人的电话\n                  consigneeTel: _this.userDefaultAddress.phoneNum,\n                  // 派送地址\n                  deliveryAddress: _this.userDefaultAddress.fullAddress,\n                  paymentWay: 'ONLINE',\n                  orderComment: _this.msg,\n                  orderDetailList: _this.orderInfo.detailArrayList\n                };\n                _context.next = 4;\n                return _this.$API.reqSubmitOrder(tradeNo, data);\n\n              case 4:\n                result = _context.sent;\n\n                // console.log(result)\n                if (result.code == 200) {\n                  _this.orderId = result.data;\n\n                  _this.$router.push('/pay?orderId=' + _this.orderId);\n                } else {\n                  alert(result.data);\n                }\n\n              case 6:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }))();\n    }\n  }\n};","map":null,"metadata":{},"sourceType":"module"}