{"ast":null,"code":"//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport ImageList from './ImageList/ImageList';\nimport Zoom from './Zoom/Zoom';\nimport { mapGetters } from 'vuex';\nexport default {\n  name: 'Detail',\n\n  data() {\n    return {\n      skuNum: 1\n    };\n  },\n\n  components: {\n    ImageList,\n    Zoom\n  },\n\n  mounted() {\n    this.$store.dispatch('getGoodInfo', this.$route.params.skuid);\n  },\n\n  computed: { ...mapGetters(['categoryView', 'skuInfo', 'spuSaleAttrList']),\n\n    skuImageList() {\n      return this.skuInfo.skuImageList || [];\n    }\n\n  },\n  methods: {\n    changeActive(saleValue, arr) {\n      arr.forEach(item => {\n        item.isChecked = '0';\n      });\n      saleValue.isChecked = '1';\n    },\n\n    // 改变商品数量的回调\n    changeSkuNum(event) {\n      // console.log(event.target.value)\n      let value = event.target.value * 1; // console.log(value)\n\n      if (isNaN(value) || value < 0) {\n        this.skuNum = 1;\n      } else {\n        this.skuNum = parseInt(value);\n      }\n    },\n\n    // 加入购物车的回调，async/awiat接收vuex返回的promise对象\n    async addShopCar() {\n      // 发请求，将产品加入数据库（通知服务器）\n      try {\n        await this.$store.dispatch('addOrUpdateShopCart', {\n          skuId: this.$route.params.skuid,\n          skuNum: this.skuNum\n        }); // 服务器存储成功，进行路由跳转, 跳转到购物车页面\n        // console.log(result)\n        // 负责的产品信息数据，通过会话存储（会话结束后数据消失）\n\n        sessionStorage.setItem('SKUINFO', JSON.stringify(this.skuInfo)); // 简单的数据如query，通过路由跳转传递\n\n        this.$router.push({\n          name: 'addcartsuccess',\n          query: {\n            skuNum: this.skuNum\n          }\n        }); //  将产品信息传给购物车组件\n        // this.$bus.$emit('addGoodInfo')\n      } catch (error) {\n        alert(error.message);\n      } // 失败，给用户进行提示\n\n    }\n\n  }\n};","map":null,"metadata":{},"sourceType":"module"}